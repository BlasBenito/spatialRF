<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tuning of random forest hyperparameters — rf_tuning • spatialRF</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Tuning of random forest hyperparameters — rf_tuning" />
<meta property="og:description" content="Tunes the random forest hyperparameters num.trees, mtry, and min.node.size via grid search by maximizing the model's R squared. Two methods are available: out-of-bag (oob), and spatial cross-validation performed with rf_evaluate()." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spatialRF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/BlasBenito/spatialRF/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tuning of random forest hyperparameters</h1>
    <small class="dont-index">Source: <a href='https://github.com/BlasBenito/spatialRF/blob/master/R/rf_tuning.R'><code>R/rf_tuning.R</code></a></small>
    <div class="hidden name"><code>rf_tuning.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Tunes the random forest hyperparameters <code>num.trees</code>, <code>mtry</code>, and <code>min.node.size</code> via grid search by maximizing the model's R squared. Two methods are available: out-of-bag (<code>oob</code>), and spatial cross-validation performed with <code><a href='rf_evaluate.html'>rf_evaluate()</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>rf_tuning</span><span class='op'>(</span>
  model <span class='op'>=</span> <span class='cn'>NULL</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"oob"</span>, <span class='st'>"spatial.cv"</span><span class='op'>)</span>,
  num.trees <span class='op'>=</span> <span class='cn'>NULL</span>,
  mtry <span class='op'>=</span> <span class='cn'>NULL</span>,
  min.node.size <span class='op'>=</span> <span class='cn'>NULL</span>,
  xy <span class='op'>=</span> <span class='cn'>NULL</span>,
  repetitions <span class='op'>=</span> <span class='cn'>NULL</span>,
  training.fraction <span class='op'>=</span> <span class='fl'>0.8</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  n.cores <span class='op'>=</span> <span class='cn'>NULL</span>,
  cluster.ips <span class='op'>=</span> <span class='cn'>NULL</span>,
  cluster.cores <span class='op'>=</span> <span class='cn'>NULL</span>,
  cluster.user <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.info.html'>Sys.info</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>[[</span><span class='st'>"user"</span><span class='op'>]</span><span class='op'>]</span>,
  cluster.port <span class='op'>=</span> <span class='st'>"11000"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>A model fitted with <code><a href='rf.html'>rf()</a></code>. If provided, the training data is taken directly from the model definition (stored in <code>model$ranger.arguments</code>). Default: <code>NULL</code></p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Character, "oob" to use RMSE values computed on the out-of-bag data to guide the tuning, and "spatial.cv", to use RMSE values from a spatial cross-validation on independent spatial folds done via <code><a href='rf_evaluate.html'>rf_evaluate()</a></code>. Default: <code>"oob"</code></p></td>
    </tr>
    <tr>
      <th>num.trees</th>
      <td><p>Numeric integer vector with the number of trees to fit on each model repetition. Default: <code><a href='https://rdrr.io/r/base/c.html'>c(500, 1000, 2000)</a></code>.</p></td>
    </tr>
    <tr>
      <th>mtry</th>
      <td><p>Numeric integer vector, number of predictors to randomly select from the complete pool of predictors on each tree split. Default: <code><a href='https://rdrr.io/r/base/Round.html'>floor(seq(1, length(predictor.variable.names), length.out = 4))</a></code></p></td>
    </tr>
    <tr>
      <th>min.node.size</th>
      <td><p>Numeric integer, minimal number of cases in a terminal node. Default: <code><a href='https://rdrr.io/r/base/c.html'>c(5, 10, 20, 40)</a></code></p></td>
    </tr>
    <tr>
      <th>xy</th>
      <td><p>Data frame or matrix with two columns containing coordinates and named "x" and "y". If <code>NULL</code>, the function will throw an error. Default: <code>NULL</code></p></td>
    </tr>
    <tr>
      <th>repetitions</th>
      <td><p>Integer, number of repetitions to compute the R squared from. If <code>method = "oob"</code>, number of repetitions to be used in <code><a href='rf_repeat.html'>rf_repeat()</a></code> to fit models for each combination of hyperparameters. If <code>method = "spatial.cv"</code>, number of independent spatial folds to use during the cross-validation. Default: <code>NULL</code> (which yields 30 for "spatial.cv" and 5 for "oob").</p></td>
    </tr>
    <tr>
      <th>training.fraction</th>
      <td><p>Proportion between 0.2 and 0.8 indicating the number of records to be used in model training. Default: <code>0.8</code></p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical. If TRUE, messages and plots generated during the execution of the function are displayed, Default: <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>n.cores</th>
      <td><p>Integer, number of cores to use during computations. If <code>NULL</code>, all cores but one are used, unless a cluster is used. Default = <code>NULL</code></p></td>
    </tr>
    <tr>
      <th>cluster.ips</th>
      <td><p>Character vector with the IPs of the machines in a cluster. The machine with the first IP will be considered the main node of the cluster, and will generally be the machine on which the R code is being executed.</p></td>
    </tr>
    <tr>
      <th>cluster.cores</th>
      <td><p>Numeric integer vector, number of cores to use on each machine.</p></td>
    </tr>
    <tr>
      <th>cluster.user</th>
      <td><p>Character string, name of the user (should be the same throughout machines). Defaults to the current system user.</p></td>
    </tr>
    <tr>
      <th>cluster.port</th>
      <td><p>Character, port used by the machines in the cluster to communicate. The firewall in all computers must allow traffic from and to such port. Default: <code>"11000"</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with four slots: <code>tuning</code> data frame with the results of the tuning analysis; <code>tuning.long</code>, a long version of the previous data frame; <code>tuning.plot</code>, ggplot of <code>tuning.long</code>; <code>ranger.arguments</code>, a list ready to be used as the argument <code>ranger.arguments</code> in <code><a href='rf_repeat.html'>rf_repeat()</a></code> or <code><a href='rf_spatial.html'>rf_spatial()</a></code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The tuning method "oob" uses as reference the RMSE computed on the out-of-bag data, while the method "spatial.cv" uses RMSE computed on spatially independent data unseen by the model. The RMSE values of the latter method will always be higher, but inform better about the capacity of the combinations of hyperparameters to yield more general models.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>plant_richness_df</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>distance_matrix</span><span class='op'>)</span>

<span class='va'>tuning</span> <span class='op'>&lt;-</span> <span class='fu'>rf_tuning</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>plant_richness_df</span>,
  dependent.variable.name <span class='op'>=</span> <span class='st'>"richness_species_vascular"</span>,
  predictor.variable.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>plant_richness_df</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>:</span><span class='fl'>21</span><span class='op'>]</span>,
  method <span class='op'>=</span> <span class='st'>"oob"</span>,
  n.cores <span class='op'>=</span> <span class='fl'>1</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='op'>}</span>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Blas M. Benito.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


