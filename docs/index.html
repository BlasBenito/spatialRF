<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Automatic generation and selection of spatial predictors for Random Forest models fitted to spatially structured data. Spatial predictors are constructed from a distance matrix among training samples using Morans Eigenvector Maps (MEMs; Dray, Legendre, and Peres-Neto 2006 &lt;DOI:10.1016/j.ecolmodel.2006.02.015&gt;) or the RFsp approach (Hengl et al. &lt;DOI:10.7717/peerj.5518&gt;). These predictors are used alongside user-supplied explanatory variables in Random Forest models. The package provides functions for model fitting, multicollinearity reduction, interaction identification, hyperparameter tuning, evaluation via spatial cross-validation, and result visualization using partial dependence and interaction plots. Model fitting relies on the ranger' package (Wright and Ziegler 2017 &lt;DOI:10.18637/jss.v077.i01&gt;).">
<title>spatialRF: Easy Spatial Regression with Random Forest • spatialRF</title>
<script src="deps/jquery-3.6.1/jquery-3.6.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="spatialRF: Easy Spatial Regression with Random Forest">
<meta property="og:description" content="Automatic generation and selection of spatial predictors for Random Forest models fitted to spatially structured data. Spatial predictors are constructed from a distance matrix among training samples using Morans Eigenvector Maps (MEMs; Dray, Legendre, and Peres-Neto 2006 &lt;DOI:10.1016/j.ecolmodel.2006.02.015&gt;) or the RFsp approach (Hengl et al. &lt;DOI:10.7717/peerj.5518&gt;). These predictors are used alongside user-supplied explanatory variables in Random Forest models. The package provides functions for model fitting, multicollinearity reduction, interaction identification, hyperparameter tuning, evaluation via spatial cross-validation, and result visualization using partial dependence and interaction plots. Model fitting relies on the ranger' package (Wright and Ziegler 2017 &lt;DOI:10.18637/jss.v077.i01&gt;).">
<!-- mathjax --><script src="file:///usr/share/javascript/mathjax/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="extra.css">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">spatialRF</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Tutorials</h6>
    <a class="dropdown-item" href="articles/non_spatial_models.html">Non-Spatial Random Forest Models</a>
    <a class="dropdown-item" href="articles/spatial_models.html">Spatial Random Forest Models</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Development</h6>
    <a class="dropdown-item" href="articles/development_roadmap.html">Development Roadmap</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/BlasBenito/spatialRF/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="spatialrf-easy-spatial-modeling-with-random-forest">
<code>spatialRF</code> Easy Spatial Modeling with Random Forest<a class="anchor" aria-label="anchor" href="#spatialrf-easy-spatial-modeling-with-random-forest"></a>
</h1></div>
<!-- badges: start -->

<!-- badges: end -->
</div>
<div class="section level1">
<h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>The package <strong>spatialRF</strong> fits <strong>explanatory spatial regression models</strong> by combining Random Forest with <em>spatial predictors</em> that help the model minimizing the spatial autocorrelation of the residuals and offering honest variable importance scores.</p>
<p>The package is designed to minimize the code required to fit a spatial model from a training dataset, the names of the response and the predictors, and a distance matrix, as shown in the mock-up call below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spatial.model</span> <span class="op">&lt;-</span> <span class="fu">spatialRF</span><span class="fu">::</span><span class="fu"><a href="reference/rf_spatial.html">rf_spatial</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  dependent.variable.name <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  predictor.variable.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pred1"</span>, <span class="st">"pred2"</span>, <span class="va">...</span>, <span class="st">"predN"</span><span class="op">)</span>,</span>
<span>  distance.matrix <span class="op">=</span> <span class="va">distance_matrix</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><strong>spatialRF</strong> uses the fast and efficient <code>ranger</code> package under the hood <a href="https://arxiv.org/abs/1508.04409" class="external-link">(Wright and Ziegler 2017)</a>, so please, cite the <code>ranger</code> package when using <code>spatialRF</code>!</p>
<p>This package also provides tools to identify potentially interesting variable interactions, tune random forest hyperparameters, assess model performance on spatially independent data folds, and examine the resulting models via importance plots, response curves, and response surfaces.</p>
<p>However, there are several things this package cannot do:</p>
<ul>
<li><p>Predict model results over raster data.</p></li>
<li><p>Predict a model over a different place with a different spatial structure.</p></li>
<li><p>Work with “big data”, whatever that means.</p></li>
<li><p>Imputation or extrapolation (it can be done, but models based on spatial predictors are hardly transferable).</p></li>
<li><p>Take temporal autocorrelation into account.</p></li>
</ul>
</div>
<div class="section level1">
<h1 id="data-requirements">Data requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h1>
<p>The data required to fit spatial models with <code>spatialRF</code> must fulfill several conditions:</p>
<ul>
<li>
<strong>The input format is data.frame</strong>. At the moment, tibbles are not fully supported.</li>
<li>
<strong>The number of rows must be somewhere between 100 and ~10000</strong> (but depends on your RAM!).</li>
<li>
<strong>Factors in the response or the predictors are not explicitly supported in the package</strong>. They may work, or they won’t, but in any case, I designed this package for <strong>quantitative responses alone</strong>. However, binary responses with values 0 and 1 are partially supported.</li>
<li>
<strong>Must be free of <code>NA</code></strong>.</li>
<li>
<strong>Columns cannot have zero variance</strong>. This condition can be checked with <code>apply(df, 2, var) == 0</code>. Columns yielding TRUE should be removed.</li>
<li>
<strong>Columns must not yield <code>NaN</code> or <code>Inf</code> when scaled</strong>. You can check each condition with <code>sum(apply(scale(df), 2, is.nan))</code> and <code>sum(apply(scale(df), 2, is.infinite))</code>. If higher than 0, you can find what columns are giving issues with <code>sapply(as.data.frame(scale(df)), function(x)any(is.nan(x)))</code> and <code>sapply(as.data.frame(scale(df)), function(x)any(is.infinite(x)))</code>. Any column yielding <code>TRUE</code> will generate issues while trying to fit models with <code>spatialRF</code>.</li>
</ul>
</div>
<div class="section level1">
<h1 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h1>
<p>If you find <code>spatialRF</code> useful, please cite the <code>ranger</code> package as well.</p>
<p><em>Marvin N. Wright, Andreas Ziegler (2017). ranger: A Fast Implementation of Random Forests for High Dimensional Data in C++ and R. Journal of Statistical Software, 77(1), 1-17. <a href="doi:10.18637/jss.v077.i01" class="uri">doi:10.18637/jss.v077.i01</a></em></p>
<p><em>Blas M. Benito (2025). spatialRF: Easy Spatial Regression with Random Forest. R package version 1.1.5. doi: 10.5281/zenodo.4745208. url: <a href="https://blasbenito.github.io/spatialRF/" class="uri">https://blasbenito.github.io/spatialRF/</a></em></p>
</div>
<div class="section level1">
<h1 id="install">Install<a class="anchor" aria-label="anchor" href="#install"></a>
</h1>
<p>The version 1.1.5 can be installed from CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"spatialRF"</span><span class="op">)</span></span></code></pre></div>
<p>The package can also be installed from GitHub as follows. There are several branches in the repository:</p>
<ul>
<li>
<code>main</code>: latest stable version (1.1.0 currently).</li>
<li>
<code>development</code>: development version, usually very broken.</li>
<li>
<code>v.1.0.9</code> to <code>v.1.1.4</code>: archived versions.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span></span>
<span>  repo <span class="op">=</span> <span class="st">"blasbenito/spatialRF"</span>,</span>
<span>  ref <span class="op">=</span> <span class="st">"main"</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h1>
<p>This README provides a quick introduction to <code>spatialRF</code>. For detailed tutorials, see:</p>
<div class="section level2">
<h2 id="tutorials">Tutorials<a class="anchor" aria-label="anchor" href="#tutorials"></a>
</h2>
<ul>
<li><p><strong><a href="https://blasbenito.github.io/spatialRF/articles/non_spatial_models.html">Non-Spatial Random Forest Models</a></strong>: Learn how to fit and interpret standard random forest models using <code><a href="reference/rf.html">rf()</a></code>. Covers data exploration, variable interactions, model evaluation, importance scores, response curves, spatial cross-validation, and prediction. <em>Start here if you’re new to spatialRF.</em></p></li>
<li><p><strong><a href="https://blasbenito.github.io/spatialRF/articles/spatial_models.html">Spatial Random Forest Models</a></strong>: Discover how to address spatial autocorrelation using <code><a href="reference/rf_spatial.html">rf_spatial()</a></code>. Demonstrates spatial predictor generation with Moran’s Eigenvector Maps, optimization, hyperparameter tuning, and model comparison.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="quick-example">Quick Example<a class="anchor" aria-label="anchor" href="#quick-example"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://blasbenito.github.io/spatialRF/">spatialRF</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">plants_df</span>, <span class="va">plants_response</span>, <span class="va">plants_predictors</span>, <span class="va">plants_distance</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a spatial random forest model</span></span>
<span><span class="va">model.spatial</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rf_spatial.html">rf_spatial</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">plants_df</span>,</span>
<span>  dependent.variable.name <span class="op">=</span> <span class="va">plants_response</span>,</span>
<span>  predictor.variable.names <span class="op">=</span> <span class="va">plants_predictors</span>,</span>
<span>  distance.matrix <span class="op">=</span> <span class="va">plants_distance</span>,</span>
<span>  distance.thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">2000</span>, <span class="fl">4000</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check residual autocorrelation</span></span>
<span><span class="fu"><a href="reference/plot_moran.html">plot_moran</a></span><span class="op">(</span><span class="va">model.spatial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View variable importance</span></span>
<span><span class="fu"><a href="reference/plot_importance.html">plot_importance</a></span><span class="op">(</span><span class="va">model.spatial</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="learn-more">Learn More<a class="anchor" aria-label="anchor" href="#learn-more"></a>
</h1>
<p>Visit the <a href="https://blasbenito.github.io/spatialRF/">package website</a> for complete function reference and additional articles.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=spatialRF" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/BlasBenito/spatialRF/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/BlasBenito/spatialRF/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing spatialRF</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://blasbenito.com" class="external-link">Blas M. Benito</a> <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-5105-7232" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://zenodo.org/badge/latestdoi/330962704" class="external-link"><img src="https://zenodo.org/badge/330962704.svg" alt="DOI"></a></li>
<li><a href="https://cran.r-project.org/package=spatialRF" class="external-link"><img src="https://www.r-pkg.org/badges/version/spatialRF" alt="CRAN status"></a></li>
<li><a href="https://CRAN.R-project.org/package=spatialRF" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/spatialRF" alt="CRAN_Download_Badge"></a></li>
<li><a href="https://github.com/BlasBenito/spatialRF/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/BlasBenito/spatialRF/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://blasbenito.com" class="external-link">Blas M. Benito</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
